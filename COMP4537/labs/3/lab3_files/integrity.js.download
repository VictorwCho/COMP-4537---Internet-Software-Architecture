!function(t){({iaLoaded:!1,blockPanel:null,loadInput:null,init:function(){let e=this;if(e.checkIALoaded(),t.top.location.href.indexOf("admin")<0&&!e.iaLoaded){let n='<div style="border: solid 5px #CCC; border-radius: 10px; padding: 40px; text-align: center;background-color: #FFFFFF;width: 50%;min-width: 300px;">';n+='<h2 style="color: #3cc52c;">Hello!</h2>',n+='<p style="text-align: left;">This activity may require the use of Integrity Advocate. <strong>Your device must provide camera/microphone access.</strong> Once you have provided your user photo and government-issued photo ID you will be granted access to the activity content.</p><p>Please ensure you have disconnected and closed any VPNs (Cisco, etc), as these can prevent your browser from accessing Integrity Advocate due to security settings.</p>',n+='<p style="text-align: left;">Integrity Advocate will load on top of this content. If the Integrity Advocate interface has not loaded after 5 seconds, <a href="https://support.integrityadvocate.com" target="_blank" >click here for troubleshooting assistance</a>.</p>',n+='<p><a href="/" style ="background-color: #006fbf;color: #FFFFFF;border-radius: 5px;border: none;padding: 10px 20px;font-size: 14px;font-weight:700; text-decoration: none;" >Exit</a></p>',n+="</div>";let o='<div style="border-radius: 10px; padding: 40px; text-align: center; background-color: rgba(255, 255, 255, 0.7); width: 50%; min-width: 300px; min-height: 60%;">';o+='<img style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);" src="https://www.integrityadvocateserver.com/images/loading-ellipsis.svg">',o+="</div>",e.blockPanel=t.top.document.createElement("div"),e.blockPanel.setAttribute("style","position: absolute; top: 0px; left: 0px; height: 100%; width: 100vw; display: flex;justify-content: center;align-items: center;"),e.blockPanel.setAttribute("id","integrityadvocate-activityblocker"),e.blockPanel.innerHTML=o,setTimeout(function(){e.blockPanel.innerHTML=n},15e3),t.top.addEventListener("DOMContentLoaded",()=>{e.iaBlockPanelExists()||t.top.document.body.appendChild(e.blockPanel),e.checkIALoaded(),e.iaLoaded||e.loadInterface()}),t.addEventListener("load",()=>{e.iaBlockPanelExists()||e.iaLoading()||t.top.document.body.appendChild(e.blockPanel),e.checkIALoaded(),e.iaLoaded||e.loadInterface()}),t.top.document.addEventListener("iterate",()=>{e.checkIALoaded(),e.iaLoaded||e.loadInterface()}),t.top.document.addEventListener("d2l-content-topic-click",()=>{e.checkIALoaded(),e.iaLoaded||e.loadInterface()})}},checkIALoaded:function(){let e=this;null!=t.top.document.getElementById("script_integrityadvocate_participantscript")&&null!=t.top.document.getElementById("script_integrityadvocate_participantscript")&&(e.iaLoaded=!0)},iaLoading:function(){return null!=t.top.document.getElementById("integrityadvocate_loadinput")&&null!=t.top.document.getElementById("integrityadvocate_loadinput")},iaBlockPanelExists:function(){return null!=t.top.document.getElementById("integrityadvocate-activityblocker")},loadInterface:function(){t.top.addEventListener("IA_Ready",function(){let e=t.top.document.getElementById("integrityadvocate-activityblocker");null!=e&&e.parentNode.removeChild(e)});let e,n=this,o=new XMLHttpRequest,i=new XMLHttpRequest;n.checkIALoaded(),n.iaLoaded||n.iaLoading()||(n.loadInput=t.top.document.createElement("input"),n.loadInput.setAttribute("type","hidden"),n.loadInput.setAttribute("id","integrityadvocate_loadinput"),n.loadInput.setAttribute("value","1"),t.top.document.body.contains(n.loadInput)||t.top.document.body.appendChild(n.loadInput),i.open("GET","/d2l/integrityadvocate/context",!0),i.onreadystatechange=function(){if(4==i.readyState)if(i.status>=500&&i.status<600)console.log("ERROR: This D2L Brightspace instance is returning the following error: "+i.statusText+" ("+i.status+")."),n.iaBlockPanelExists()&&t.top.document.body.removeChild(n.blockPanel);else{let a=JSON.parse(i.response),d=a.IntegrityAdvocateConfig.AppId,c=a.ActivityContext.OrgUnitId,l="",r=a.UserContext.FirstName,s=a.UserContext.LastName,p=a.UserContext.UserId,u=a.UserContext.ExternalEmail;"Quiz"==a.ActivityContext.ActivityType&&(l=a.ActivityContext.ActivityId),"Assignment"==a.ActivityContext.ActivityType&&(l="assignment_"+a.ActivityContext.ActivityId),a.ActivityContext.ActivityType.indexOf("Content")>-1&&(l="content_"+a.ActivityContext.ActivityId),n.checkIALoaded(),n.iaLoaded||(o.open("GET","https://ca.integrityadvocateserver.com/api/d2lactivitysettings?appid="+encodeURIComponent(d)+"&activityid="+encodeURIComponent(l),!0),o.onreadystatechange=function(){if(4==o.readyState){e=JSON.parse(o.response);let i="",m="",y="",v="&refererurl="+encodeURIComponent(t.location.href),g=!1;if(null!=e&&null!=e&&null!=e.Rules&&(i="&rules="+encodeURIComponent(e.Rules)),null!=e&&null!=e&&null!=e.ActivationName&&(y="&activationname="+encodeURIComponent(e.ActivationName)),null!=e&&null!=e&&null!=e.Enabled&&"-1"!=e.Enabled&&(g=!0),g){t.top.location.href.indexOf("quiz_summary")>-1&&(m="&bpfs=1");let e="https://ca.integrityadvocateserver.com/participants/integrity";t.top.location.href.indexOf("iaqa.devlms.brightspace.com")>-1?e="https://q696mqu91m.execute-api.ca-central-1.amazonaws.com/default/participants/integrity":t.top.location.href.indexOf("iadev.devlms.brightspace.com")>-1&&(e="https://q696mqu91m.execute-api.ca-central-1.amazonaws.com/default/participants/dev-integrity");let o=t.top.document.createElement("script");o.type="text/javascript",o.setAttribute("id","script_integrityadvocate_participantscript"),o.src=e+"?appid="+d+"&participantidentifier="+encodeURIComponent(p+"_"+c)+"&participantfirstname="+encodeURIComponent(r)+"&participantlastname="+encodeURIComponent(s)+"&participantemail="+encodeURIComponent(u)+"&externaluserid="+encodeURIComponent(a.UserContext.OrgDefinedId)+"&courseid="+encodeURIComponent(c)+"&activityid="+encodeURIComponent(l)+y+i+m+v,n.checkIALoaded(),n.iaLoaded||t.top.document.body.appendChild(o)}else n.iaBlockPanelExists()&&t.top.document.body.removeChild(n.blockPanel)}},o.send())}},i.send())}}).init()}(window);